@model AgroEnsayos.Models.SearchModel
@using AgroEnsayos.Entities;
@{
    Producto producto1 = ViewBag.Producto1 as Producto;
    Producto producto2 = ViewBag.Producto2 as Producto;
    Producto producto3 = ViewBag.Producto3 as Producto;
    Producto producto4 = ViewBag.Producto4 as Producto;
    Producto producto5 = ViewBag.Producto5 as Producto;

    List<Atributo> atributos1 = ViewBag.Atributo1 as List<Atributo>;
    List<Atributo> atributos2 = ViewBag.Atributo2 as List<Atributo>;
    List<Atributo> atributos3 = ViewBag.Atributo3 as List<Atributo>;
    List<Atributo> atributos4 = ViewBag.Atributo4 as List<Atributo>;
    List<Atributo> atributos5 = ViewBag.Atributo5 as List<Atributo>;

    List<Atributo> atr_comp = ViewBag.AtrComp as List<Atributo>;

    int par1 = 0;
    int par2 = 0;
    int par3 = 0;
    int par4 = 0;
    int par5 =0;

    int id1 = ViewBag.id1;
    int id2 = ViewBag.id2;
    int id3 = ViewBag.id3;
    int id4 = ViewBag.id4;
    int id5 = ViewBag.id5;
    
    int prodCount = 0;
    
    List<List<string>> atr_fijos = new List<List<string>>();
    List<string> material = new List<string>();
    List<string> hibrido = new List<string>();
    List<string> ciclo = new List<string>();
    List<string> convencional = new List<string>();
    List<string> floracion = new List<string>();
    List<string> madurez = new List<string>();
    List<string> alturaPlanta = new List<string>();
    List<string> nuevo = new List<string>();

    for (int i = 0; i < 6;i++ )
    {
        if (i == 0)
        {
            material.Add("Material");
            hibrido.Add("Hibrido");
            ciclo.Add("Ciclo");
            convencional.Add("Convencional");
            floracion.Add("Floracion");
            madurez.Add("Madurez");
            alturaPlanta.Add("Altura");
            nuevo.Add("Nuevo");
        }
        else
        {
            material.Add("");
            hibrido.Add("No");
            ciclo.Add("");
            convencional.Add("No");
            floracion.Add("");
            madurez.Add("");
            alturaPlanta.Add("");
            nuevo.Add("No");
        }
    }
        
    
    int bAtr = 0;

    if (producto1 != null)
    {
        par1 = producto1.Id;
        material[1] = producto1.Material;
        ciclo[1] = producto1.Ciclo == null ? "" : producto1.Ciclo.ToString();
        floracion[1] = producto1.DiasFloracion.ToString();
        madurez[1] = producto1.DiasMadurez == null ? "" : producto1.DiasMadurez.ToString();
        alturaPlanta[1] = producto1.AlturaPlanta.ToString();
        if(Convert.ToBoolean(producto1.EsHibrido))
        {
            hibrido[1] = "Si";
        }
        if (Convert.ToBoolean(producto1.EsConvencional))
        {
            convencional[1] = "Si";
        }
        if (Convert.ToBoolean(producto1.EsNuevo))
        {
            nuevo[1] = "Si";
        }
    }
    if (producto2 != null)
    {
        par2 = producto2.Id;
        material[2] = producto2.Material;
        ciclo[2] = producto2.Ciclo == null ? "" : producto2.Ciclo.ToString();
        floracion[2] = producto2.DiasFloracion.ToString();
        madurez[2] = producto2.DiasMadurez == null ? "" : producto2.DiasMadurez.ToString();
        alturaPlanta[2] = producto2.AlturaPlanta.ToString();
        if (Convert.ToBoolean(producto2.EsHibrido))
        {
            hibrido[2] = "Si";
        }
        if (Convert.ToBoolean(producto2.EsConvencional))
        {
            convencional[2] = "Si";
        }
        if (Convert.ToBoolean(producto2.EsNuevo))
        {
            nuevo[2] = "Si";
        }
    }
    if (producto3 != null)
    {
        par3 = producto3.Id;
        material[3] = producto3.Material;
        ciclo[3] = producto3.Ciclo == null ? "" : producto3.Ciclo.ToString();
        floracion[3] = producto3.DiasFloracion.ToString();
        madurez[3] = producto3.DiasMadurez == null ? "" : producto3.DiasMadurez.ToString();
        alturaPlanta[3] = producto3.AlturaPlanta.ToString();
        if (Convert.ToBoolean(producto3.EsHibrido))
        {
            hibrido[3] = "Si";
        }
        if (Convert.ToBoolean(producto3.EsConvencional))
        {
            convencional[3] = "Si";
        }
        if (Convert.ToBoolean(producto3.EsNuevo))
        {
            nuevo[3] = "Si";
        }
    }
    if (producto4 != null)
    {
        par4 = producto4.Id;
        material[4] = producto4.Material;
        ciclo[4] = producto4.Ciclo == null ? "" : producto4.Ciclo.ToString();
        floracion[4] = producto4.DiasFloracion.ToString();
        madurez[4] = producto4.DiasMadurez == null ? "" : producto4.DiasMadurez.ToString();
        alturaPlanta[4] = producto4.AlturaPlanta.ToString();
        if (Convert.ToBoolean(producto4.EsHibrido))
        {
            hibrido[4] = "Si";
        }
        if (Convert.ToBoolean(producto4.EsConvencional))
        {
            convencional[4] = "Si";
        }
        if (Convert.ToBoolean(producto4.EsNuevo))
        {
            nuevo[4] = "Si";
        }
    }
    if (producto5 != null)
    {
        par5 = producto5.Id;
        material[5] = producto5.Material;
        ciclo[5] = producto5.Ciclo == null ? "" : producto5.Ciclo.ToString();
        floracion[5] = producto5.DiasFloracion.ToString();
        madurez[5] = producto5.DiasMadurez == null ? "" : producto5.DiasMadurez.ToString();
        alturaPlanta[5] = producto5.AlturaPlanta.ToString();
        if (Convert.ToBoolean(producto5.EsHibrido))
        {
            hibrido[5] = "Si";
        }
        if (Convert.ToBoolean(producto5.EsConvencional))
        {
            convencional[5] = "Si";
        }
        if (Convert.ToBoolean(producto5.EsNuevo))
        {
            nuevo[5] = "Si";
        }
    }

    atr_fijos.Add(material);
    atr_fijos.Add(hibrido);
    atr_fijos.Add(ciclo);
    atr_fijos.Add(convencional);
    atr_fijos.Add(floracion);
    atr_fijos.Add(madurez);
    atr_fijos.Add(alturaPlanta);
    atr_fijos.Add(nuevo);
    
        
}

    @using (Html.BeginForm("Resultados", "Productos", FormMethod.Post, new { id = "Resultform" }))
    {
        <div class="container header header3">
            <div class="logo2">
                <a href="/Home/" title="Volver a la Página Principal">
                    <img src="/images/logo.png" class="logo"></a>
            </div>
            <div class="searchrow2">
                <input type="hidden" value="@Model.CategoriaIdProductos" id="CategoriaIdProductos" name="CategoriaIdProductos">
                <input data-val="true" data-val-required="Debe escribir algo" id="BuscarProductos" name="BuscarProductos" class="searchtext big" placeholder="Buscar" type="text" value="@Model.BuscarProductos"><input type="submit" class="searchicon" style="margin-right: 50px" value=""><input type="button" class="userbutton" />
            </div>
     
        </div>
        <div class="container header header3" style="height: 40px;">
            <div class="breadcrumb" style="float:left">
                @Html.ActionLink("Cultivos", "Index", "Home")
                @if (Model.Categoria != null)
                {
                    <span>&nbsp;>&nbsp;</span>
                    @Html.ActionLink(Model.Categoria, "Busqueda/" + Model.CategoriaIdProductos, "Home")
                }
                <span>&nbsp;>&nbsp;</span>
                @Html.ActionLink("Productos", "Resultados", "Productos", new { CategoriaIdProductos= Model.CategoriaIdProductos ,BuscarProductos = Model.BuscarProductos }, null)
                
                <span>&nbsp;>&nbsp;</span>
                @Html.ActionLink("Comparativo", "Comparar", "Productos", new { CategoriaIdProductos=Model.CategoriaIdProductos, id1 = par1, id2 = par2, id3 = par3, id4 = par4, id5 = par5 } , new {  })
                
            </div>
        </div>
    }
    <div class="container header3" style="background-color: #f7f7f7">
            <div style="float: left; background-color: #ffffff; padding-left: 10px;width:99%; padding-bottom: 10px">
              <div class="title_label" style="float:left;color: #05C524;margin-bottom: 15px;">Comparativo</div>
                @Html.Hidden("id1", id1)
                        @Html.Hidden("id2", id2)
                        @Html.Hidden("id3", id3)
                        @Html.Hidden("id4", id4)
                        @Html.Hidden("id5", id5)  
                 <div id="div_detail" name="div_detail" class="marr le datatable">
        <table id="detailstable" style=" border: 0px;float:left;">
            <thead>
                <tr class="ui-widget-header">
                    <th style="width: 200px;background-color: #8D2602;color:white">Propiedades</th>
                    @if(producto1 != null)
                    {
                        prodCount++;
                        <th>@producto1.Nombre</th>
                    }
                    @if(producto2 != null)
                    {
                        prodCount++;
                        <th>@producto2.Nombre</th>
                    }
                    @if (producto3 != null)
                    {
                        prodCount++;
                        <th>@producto3.Nombre</th>
                    }
                    @if(producto4 != null)
                    {
                        prodCount++;
                        <th>@producto4.Nombre</th>
                    }
                    @if(producto5 != null)
                    {
                        prodCount++;
                        <th>@producto5.Nombre</th>
                    }
                </tr>
            </thead>
            <tbody>
                
                @for (int i = 0; i < 8;i++ )
                {
                    <tr>
                    <td style="font-weight:bold;background-color: #f7f7f7;color: #8D2602;">@atr_fijos[i][0].ToString()</td>
                    @for(int j=1;j<=prodCount;j++)
                    {
                        if(atr_fijos[i][j] != null)
                        {
                            <td style="font-weight:bold;">@atr_fijos[i][j].ToString()</td>
                        }
                        else
                        {
                            <td style="font-weight:bold;">-</td>
                        }
                    }
                    </tr>
                }
                
                @if (atr_comp != null)
                {
                    foreach (Atributo atr in atr_comp)
                    {
                        <tr>
                            <td style="font-weight:bold;background-color: #f7f7f7;color: #8D2602;">@atr.Nombre</td>
                        
                        @if (atributos1 != null)
                        {
                            if (bAtr != 0)
                            {
                                bAtr = 0;
                            }
                            foreach (Atributo at in atributos1)
                            {
                                if (at.Id == atr.Id)
                                {
                                    bAtr = 1; 
                                    <td style="font-weight:bold;">@at.equivalencia_valor</td>
                                }
                            }
                            if (bAtr == 0)
                            {
                                <td>&nbsp;</td>
                            }
                        }
                        @if (atributos2 != null)
                        {
                            if (bAtr != 0)
                            {
                                bAtr = 0;
                            }
                            foreach (Atributo at in atributos2)
                            {
                                if (at.Id == atr.Id)
                                {
                                    bAtr = 1; 
                                    <td style="font-weight:bold;">@(at.equivalencia_valor==""?"-":at.equivalencia_valor)</td>
                                }
                            }
                            if (bAtr == 0)
                            {
                                <td>&nbsp;</td>
                            }
                        }
                        @if (atributos3 != null)
                        {
                            if (bAtr != 0)
                            {
                                bAtr = 0;
                            }
                            foreach (Atributo at in atributos3)
                            {
                                if (at.Id == atr.Id)
                                {
                                    bAtr = 1; 
                                    <td style="font-weight:bold;">@(at.equivalencia_valor==""?"-":at.equivalencia_valor)</td>
                                }
                            }
                            if (bAtr == 0)
                            {
                                <td>&nbsp;</td>
                            }
                        }
                        @if (atributos4 != null)
                        {
                            if (bAtr != 0)
                            {
                                bAtr = 0;
                            }
                            foreach (Atributo at in atributos4)
                            {
                                if (at.Id == atr.Id)
                                {
                                    bAtr = 1; 
                                    <td style="font-weight:bold;">@(at.equivalencia_valor==""?"-":at.equivalencia_valor)</td>
                                }
                            }
                            if (bAtr == 0)
                            {
                                <td>&nbsp;</td>
                            }
                        }
                        @if (atributos5 != null)
                        {
                            if (bAtr != 0)
                            {
                                bAtr = 0;
                            }
                            foreach (Atributo at in atributos5)
                            {
                                if (at.Id == atr.Id)
                                {
                                    bAtr = 1; 
                                    <td style="font-weight:bold;">@(at.equivalencia_valor==""?"-":at.equivalencia_valor)</td>
                                }
                            }
                            if (bAtr == 0)
                            {
                                <td>&nbsp;</td>
                            }
                        }

                        </tr>
                    }
                }
            </tbody>
            </table>             

             <div style="clear: both;"></div>
                <div style="padding-left:10px;margin-top:10px;"><span style="font-weight:bold">* Para mas información, remitase al sitio web de la empresa semillera.</span></div>  
             
            <div style="clear: both;"></div>
        </div>
        </div>

